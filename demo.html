<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Try It Yourself: Interactive Modeling</title>

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="d-flex" id="wrapper">
    <!-- Sidebar -->
    <div class="bg-light border-end" id="sidebar-wrapper">
      <div class="sidebar-heading text-center py-4">
        <strong>Navigation</strong>
      </div>
      <div class="list-group list-group-flush">
        <a href="index.html" class="list-group-item list-group-item-action bg-light">
          Homepage
        </a>
        <a href="data-dictionary.html" class="list-group-item list-group-item-action bg-light">
          Data Dictionary
        </a>
        <a href="eda.html" class="list-group-item list-group-item-action bg-light">
          Exploratory Data Analysis (EDA)
        </a>
        <a href="key-findings.html" class="list-group-item list-group-item-action bg-light">
          Key Findings
        </a>
        <a href="demo.html" class="list-group-item list-group-item-action bg-light active">
          Try It Yourself: Interactive Modeling
        </a>
        <a href="contact-us.html" class="list-group-item list-group-item-action bg-light">
          Contact Us
        </a>
      </div>
      <div class="p-3">
        <a href="research-paper.pdf" target="_blank" class="btn btn-primary w-100">
          View PDF
        </a>
      </div>
    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">
      <nav class="navbar navbar-expand-lg navbar-light bg-white border-bottom">
        <div class="container-fluid">
          <button class="btn btn-secondary" id="menu-toggle">
            Toggle Menu
          </button>
        </div>
      </nav>

      <div class="container-fluid py-4">
        <h1 class="display-5 mb-4">Try It Yourself: Interactive Modeling</h1>

        <p class="text-muted">
          Use the input fields below to customize property details and key market indicators. 
          The model will analyze your inputs to predict rent trends and other relevant housing 
          insights. Once you submit, the system will generate a prediction, including key metrics 
          such as confidence levels and accuracy. 
        
          Below the results, you'll find an embedded visualization that helps illustrate the 
          model's predictions in a meaningful way. Use this to understand market conditions, 
          compare trends, and make informed decisions based on data-driven insights.
        </p>        

        <!-- Form for Inputs -->
        <div class="card mb-4">
          <div class="card-header">
            <h5 class="mb-0">Model Inputs</h5>
          </div>
          <div class="card-body">
            <form id="model-form">
              <!-- Input Fields -->
              <div class="mb-3">
                <label for="propertyName" class="form-label">Property Name (Optional)</label>
                <input type="text" class="form-control" id="propertyName" name="propertyName" placeholder="e.g. Sunset Apartments" />
                <small class="form-text text-muted">Enter the name of the property (if applicable). This helps identify the listing.</small>
              </div>

              <div class="mb-3">
                <label for="propertyState" class="form-label">State (Optional)</label>
                <input type="text" class="form-control" id="propertyState" name="propertyState" placeholder="e.g. California" />
                <small class="form-text text-muted">Specify the state where the property is located. Example: "California".</small>
              </div>

              <div class="mb-3">
                <label for="propertyCity" class="form-label">City (Optional)</label>
                <input type="text" class="form-control" id="propertyCity" name="propertyCity" placeholder="e.g. Los Angeles" />
                <small class="form-text text-muted">Enter the city where the property is located. Example: "Los Angeles".</small>
              </div>

              <div class="mb-3">
                <label for="propertyAddress" class="form-label">Address (Optional)</label>
                <input type="text" class="form-control" id="propertyAddress" name="propertyAddress" placeholder="e.g. 123 Main St" />
                <small class="form-text text-muted">Provide the street address of the property. This is useful for exact location identification.</small>
              </div>

              <div class="mb-3">
                <label for="propertyZip" class="form-label">Zip Code (Optional)</label>
                <input type="text" class="form-control" id="propertyZip" name="propertyZip" placeholder="e.g. 90001" />
                <small class="form-text text-muted">Enter the 5-digit ZIP code of the property. Example: "90001".</small>
              </div>

              <!-- HeroSource Variable (Radio Buttons) -->
              <div class="mb-3">
                <label class="form-label">HeroSource Variable (1 = RealPage, 0 = Non-RealPage)</label>
                <small class="form-text text-muted">Select whether the data source is from **RealPage (1)** or **another source (0)**.</small>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="heroSource" id="heroSource1" value="1" required>
                    <label class="form-check-label" for="heroSource1">RealPage (1)</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="heroSource" id="heroSource0" value="0" required>
                    <label class="form-check-label" for="heroSource0">Non-RealPage (0)</label>
                </div>
              </div>

              <button type="submit" class="btn btn-primary">
                Submit &amp; Predict
              </button>
            </form>
          </div>
        </div>

        <!-- Display Model Output (text) -->
        <div id="model-output" class="alert alert-info d-none" role="alert">
          <!-- Script updates this with the API response -->
        </div>

        <!-- Visualization Container (hidden by default) -->
        <div class="card mb-4 d-none" id="prediction-vis-container">
          <div class="card-header">
            <h5 class="mb-0">Prediction-based Visualization</h5>
          </div>
          <div class="card-body">
            <p class="mb-3 text-muted">
              Below is a visualization relevant to your model results.
            </p>
            <!-- Use ratio-16x9 for responsive iframes -->
            <div class="ratio ratio-16x9">
              <iframe 
                src="" 
                id="prediction-iframe"
                frameborder="0" 
                allowfullscreen>
              </iframe>
            </div>
          </div>
        </div>

      </div>
      <!-- Footer with link to the Full Privacy Policy -->
      <footer class="bg-light text-center py-3 mt-5 border-top">
        <p class="mb-0">
          &copy; 2025 RealPage Collusion Dashboard &mdash; 
          <a href="privacy.html">View Full Privacy Policy</a>
        </p>
      </footer>
    </div>
    <!-- /#page-content-wrapper -->
  </div>
  <!-- /#wrapper -->

  <!-- Bootstrap Bundle JS -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
  ></script>

  <!-- Script to toggle the sidebar -->
  <script>
    const menuToggle = document.getElementById("menu-toggle");
    const wrapper = document.getElementById("wrapper");
    menuToggle.addEventListener("click", () => {
      wrapper.classList.toggle("toggled");
    });
  </script>

  <!-- Script to handle the form submission and display prediction-based visualization -->
  <script>
    const form = document.getElementById('model-form');
    const outputDiv = document.getElementById('model-output');
    const visContainer = document.getElementById('prediction-vis-container');
    const visIframe = document.getElementById('prediction-iframe');
    const heroSourceInput = document.querySelector('input[name="heroSource"]:checked');
    const heroSourceValue = heroSourceInput ? Number(heroSourceInput.value) : null; 

    form.addEventListener('submit', event => {
      event.preventDefault();

      // Prepare a payload for your API
      const payload = {
        propertyName: document.getElementById('propertyName').value || null,
        propertyState: document.getElementById('propertyState').value || null,
        propertyCity: document.getElementById('propertyCity').value || null,
        propertyAddress: document.getElementById('propertyAddress').value || null,
        propertyZip: document.getElementById('propertyZip').value || null,
        heroSource: heroSourceValue,
      };

      // Clear any old messages
      outputDiv.classList.add('d-none');
      outputDiv.classList.remove('alert-danger');
      visContainer.classList.add('d-none');
      visIframe.src = ""; // reset

      // Example fetch call to a hypothetical endpoint
      fetch('https://api.example.com/predict', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      })
      .then(response => response.json())
      .then(data => {
        // Show the output text
        outputDiv.classList.remove('d-none');
        outputDiv.innerHTML = `
          <strong>Model Prediction:</strong> ${data.prediction} <br>
          <strong>Confidence:</strong> ${data.confidence}% 
          <small class="text-muted" title="Confidence score represents how certain the model is about its prediction. Higher values indicate stronger certainty.">ⓘ</small> <br>
          
          ${data.accuracy ? `<strong>Accuracy:</strong> ${data.accuracy}% 
          <small class="text-muted" title="Accuracy measures the percentage of correct predictions. Useful for balanced datasets.">ⓘ</small> <br>` : ""}

          ${data.precision ? `<strong>Precision:</strong> ${data.precision} 
          <small class="text-muted" title="Precision measures how many predicted positives are actually correct. High precision means fewer false positives.">ⓘ</small> <br>` : ""}

          ${data.recall ? `<strong>Recall:</strong> ${data.recall} 
          <small class="text-muted" title="Recall measures how many actual positives were correctly identified. High recall means fewer false negatives.">ⓘ</small> <br>` : ""}

          ${data.f1Score ? `<strong>F1-Score:</strong> ${data.f1Score} 
          <small class="text-muted" title="F1-Score balances Precision & Recall. Useful for imbalanced datasets.">ⓘ</small> <br>` : ""}

          ${data.mse ? `<strong>Mean Squared Error (MSE):</strong> ${data.mse} 
          <small class="text-muted" title="MSE measures average squared differences between predicted and actual values. Lower is better.">ⓘ</small> <br>` : ""}

          ${data.mae ? `<strong>Mean Absolute Error (MAE):</strong> ${data.mae} 
          <small class="text-muted" title="MAE measures the average absolute differences between predictions and actual values. Lower is better.">ⓘ</small> <br>` : ""}

          ${data.rSquared ? `<strong>R² Score:</strong> ${data.rSquared} 
          <small class="text-muted" title="R² shows how well the model explains variance in data. Closer to 1 is better.">ⓘ</small> <br>` : ""}

          ${data.aucRoc ? `<strong>AUC-ROC Score:</strong> ${data.aucRoc} 
          <small class="text-muted" title="AUC-ROC measures model's ability to distinguish between classes. Closer to 1 is better.">ⓘ</small> <br>` : ""}

          ${data.logLoss ? `<strong>Log Loss:</strong> ${data.logLoss} 
          <small class="text-muted" title="Log Loss quantifies classification model uncertainty. Lower is better.">ⓘ</small> <br>` : ""}
        `;

        // Now let's assume the API also returns a URL for a relevant visualization
        if (data.visualUrl) {
          visIframe.src = data.visualUrl;
          visContainer.classList.remove('d-none');
        }
      })
      .catch(err => {
        outputDiv.classList.remove('d-none');
        outputDiv.classList.add('alert-danger');
        outputDiv.textContent = 
          'Error fetching model prediction. Please try again.';
        console.error(err);
      });
    });
  </script>
</body>
</html>